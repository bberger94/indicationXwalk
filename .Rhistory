library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#load manually revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
rm(list = ls())
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#load manually revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 %>% !is.na] %>% print
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 %>% is.na %>% !] %>% print
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 %>% is.na] %>% print
xwalk.icd9$icd9[!xwalk.icd9$revised_icd9 %>% is.na] %>% print
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] %>% print
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <- xwalk.icd9$revised_icd9
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
rm(list = ls())
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <- xwalk.icd9$revised_icd9
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
rm(list = ls())
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <- xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <- xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#get condition labels
xwalk.icd9$icd9_category <- icd_explain_table(xwalk.icd9$icd9)$major
xwalk.icd9$icd9_sub_chapter <- icd_explain_table(xwalk.icd9$icd9)$sub_chapter
xwalk.icd9$icd9_chapter <- icd_explain_table(xwalk.icd9$icd9)$chapter
#select variables & sort
xwalk.icd9 <-
xwalk.icd9 %>%
select(cortellis_condition = condition,
is_cancer,
starts_with('icd9')
) %>%
arrange(as.numeric(icd9))
#get condition labels
xwalk.icd9$icd9_category <- icd_explain_table(xwalk.icd9$icd9)$major
xwalk.icd9$icd9_sub_chapter <- icd_explain_table(xwalk.icd9$icd9)$sub_chapter
xwalk.icd9$icd9_chapter <- icd_explain_table(xwalk.icd9$icd9)$chapter
#select variables & sort
xwalk.icd9 <-
xwalk.icd9 %>%
select(cortellis_condition = condition,
starts_with('icd9')
) %>%
arrange(as.numeric(icd9))
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <- xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#Replace revised icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
xwalk.icd9 %>% arrange(icd9) %>% View
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <- xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#Replace revised icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#get condition labels
xwalk.icd9$icd9_category <- icd_explain_table(xwalk.icd9$icd9)$major
xwalk.icd9$icd9_sub_chapter <- icd_explain_table(xwalk.icd9$icd9)$sub_chapter
xwalk.icd9$icd9_chapter <- icd_explain_table(xwalk.icd9$icd9)$chapter
View(xwalk.icd9)
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <- xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#Replace revised icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
View(xwalk.icd9)
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <-
xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#Replace revised icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Replace malignant_not_specified with 0 if NA
xwalk.icd9$malignant_not_specified[is.na(xwalk.icd9$malignant_not_specified)] <- 0
#get condition labels
xwalk.icd9$icd9_category <- icd_explain_table(xwalk.icd9$icd9)$major
xwalk.icd9$icd9_sub_chapter <- icd_explain_table(xwalk.icd9$icd9)$sub_chapter
xwalk.icd9$icd9_chapter <- icd_explain_table(xwalk.icd9$icd9)$chapter
#select variables & sort
xwalk.icd9 <-
xwalk.icd9 %>%
select(cortellis_condition = condition,
starts_with('icd9')
) %>%
arrange(as.numeric(icd9))
View(xwalk.icd9)
xwalk.icd9 <-
xwalk.icd9 %>%
select(cortellis_condition = condition,
starts_with('icd9'),
malignant_not_specified
) %>%
arrange(as.numeric(icd9))
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <-
xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#Replace revised icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Replace malignant_not_specified with 0 if NA
xwalk.icd9$malignant_not_specified[is.na(xwalk.icd9$malignant_not_specified)] <- 0
#get condition labels
xwalk.icd9$icd9_category <- icd_explain_table(xwalk.icd9$icd9)$major
xwalk.icd9$icd9_sub_chapter <- icd_explain_table(xwalk.icd9$icd9)$sub_chapter
xwalk.icd9$icd9_chapter <- icd_explain_table(xwalk.icd9$icd9)$chapter
#select variables & sort
xwalk.icd9 <-
xwalk.icd9 %>%
select(cortellis_condition = condition,
starts_with('icd9'),
malignant_not_specified
) %>%
arrange(as.numeric(icd9))
View(xwalk.icd9)
rm(list = ls())
#load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <-
xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#Replace revised icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Replace malignant_not_specified with 0 if NA
xwalk.icd9$malignant_not_specified[is.na(xwalk.icd9$malignant_not_specified)] <- 0
#get condition labels
xwalk.icd9$icd9_category <- icd_explain_table(xwalk.icd9$icd9)$major
xwalk.icd9$icd9_sub_chapter <- icd_explain_table(xwalk.icd9$icd9)$sub_chapter
xwalk.icd9$icd9_chapter <- icd_explain_table(xwalk.icd9$icd9)$chapter
#select variables & sort
xwalk.icd9 <-
xwalk.icd9 %>%
select(cortellis_condition = condition,
starts_with('icd9'),
malignant_not_specified
) %>%
arrange(as.numeric(icd9))
View(xwalk.icd9)
sum(unique(xwalk.icd9$icd9_sub_chapter))
unique(xwalk.icd9$icd9_sub_chapter)
uniquel(xwalk.icd9$icd9_sub_chapter)
unique(xwalk.icd9$icd9_sub_chapter)
levels(unique(xwalk.icd9$icd9_sub_chapter))
rm(list = ls())
#Load these packages:
packages <- c('rio', 'dplyr', 'icd')
for(package in packages){
#INSTALL PACKAGES BEFORE RUNNING SCRIPT FOR FIRST TIME BY UNCOMMENTING LINE BELOW
#install.packages(package) #if asked to restart, choose NO
library(package, character.only = T)
}
#Load indication -> icd9 crosswalk
xwalk.icd9 <-
import('data/Cortellis_Drug_Indication_ICD9_Crosswalk.dta') %>%
filter(condition != 'unidentified indication') %>%
arrange(icd9)
#Replace these (incorrect) codings
xwalk.icd9$icd9[xwalk.icd9$icd9 > 999] <- NA
#Use icd package to code as icd9
xwalk.icd9$icd9 <-
xwalk.icd9$icd9 %>%
as.character() %>%
as.icd9()
#Replace icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Load revised matches
xwalk.icd9 <-
import('data/validatedInd2ICD/cancer/Cortellis_Drug_Indication_ICD9_Crosswalk_Cancer_ben.xlsx') %>%
select(condition = cortellis_condition,
revised_icd9 = revised_icd9_ben,
malignant_not_specified) %>%
right_join(xwalk.icd9, by = 'condition')
#Replace ICD-9s with revised ICD-9s
xwalk.icd9$icd9[!is.na(xwalk.icd9$revised_icd9)] <-
xwalk.icd9$revised_icd9[!is.na(xwalk.icd9$revised_icd9)]
#Replace ICD-9s where there is no appropriate match with NA
xwalk.icd9$icd9[xwalk.icd9$revised_icd9 == 'No appropriate ICD-9'] <- NA
#Replace revised icd9s with character codings
xwalk.icd9$icd9 <- icd_short_to_decimal(xwalk.icd9$icd9)
#Replace malignant_not_specified with 0 if NA
xwalk.icd9$malignant_not_specified[is.na(xwalk.icd9$malignant_not_specified)] <- 0
#get condition labels
xwalk.icd9$icd9_category <- icd_explain_table(xwalk.icd9$icd9)$major
xwalk.icd9$icd9_sub_chapter <- icd_explain_table(xwalk.icd9$icd9)$sub_chapter
xwalk.icd9$icd9_chapter <- icd_explain_table(xwalk.icd9$icd9)$chapter
#select variables & sort
xwalk.icd9 <-
xwalk.icd9 %>%
select(cortellis_condition = condition,
starts_with('icd9'),
malignant_not_specified
) %>%
arrange(as.numeric(icd9))
xwalk.icd9 %>%
export('data/Cortellis_Drug_Indication_ICD9_Crosswalk_cancerValidated.csv')
